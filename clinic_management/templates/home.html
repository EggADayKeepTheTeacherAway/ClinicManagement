{% extends 'base.html' %}
{% block content %}
{% load static %}

<head>
    <title>Clinic Management System</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" href="{% static 'main.css' %}">
</head>
<body>
    <div class="container my-5">
        <div class="text-center mb-4 py-3">
            <h1 class="display-5 fw-bold">Clinic Management System</h1>
            <hr class="w-25 mx-auto">
            <p class="text-muted">A streamlined dashboard for healthcare professionals</p>
        </div>

        <div class="table-responsive">
            <table id="mergedTable" class="table table-striped table-bordered display nowrap" style="width:100%">
                <thead>
                    <tr>
                        <th>Patient ID</th>
                        <th>Patient Name</th>
                        <th>Phone</th>
                        <th>Email</th>
                        <th>Birthdate</th>
                        <th>Weight</th>
                        <th>Height</th>
                        <th>Emergency Contact</th>
                        <th>Doctor ID</th>
                        <th>Doctor Name</th>
                        <th>Doctor Phone</th>
                        <th>Doctor Email</th>
                        <th>Specialization</th>
                        <th>Appointment Date</th>
                        <th>Insurance Provider</th>
                        <th>Coverage Percentage</th>
                        <th>Medical Record Summary</th>
                        <th>Disease Name</th>
                        <th>Medicines</th>
                        <th>Treatment Type</th>
                        <th>Payment Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for data in merged_data %}
                    <tr>
                        <td>{{ data.patient_id }}</td>
                        <td>{{ data.patient_name }}</td>
                        <td>{{ data.patient_phone }}</td>
                        <td>{{ data.patient_email }}</td>
                        <td>{{ data.patient_birthdate }}</td>
                        <td>{{ data.patient_weight }}</td>
                        <td>{{ data.patient_height }}</td>
                        <td>{{ data.patient_emergency }}</td>
                        <td>{{ data.doctor_id }}</td>
                        <td>{{ data.doctor_name }}</td>
                        <td>{{ data.doctor_phone }}</td>
                        <td>{{ data.doctor_email }}</td>
                        <td>{{ data.doctor_specialization }}</td>
                        <td>{{ data.appointment_date }}</td>
                        <td>{{ data.insurance_provider }}</td>
                        <td>{{ data.coverage_percentage }}</td>
                        <td>{{ data.medical_record_summary }}</td>
                        <td>{{ data.disease_name }}</td>
                        <td>
                            {% for medicine in data.medicines_for_appointment %}
                                <div>{{ medicine.Name }} ({{ medicine.Brand }})</div>
                            {% empty %}
                                <div class="no-medicines">No medicines</div>
                            {% endfor %}
                        </td>
                        <td>{{ data.treatment_type }}</td>
                        <td>{{ data.payment_status }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap5.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#mergedTable').DataTable({
                responsive: true,
                scrollX: true,
                paging: true,
                lengthChange: true,
                pageLength: 10,
                ordering: true,
                autoWidth: false,
            });
        });
    </script>
</body>
{% endblock %}
